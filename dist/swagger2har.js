!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).swagger2har={})}(this,function(e){"use strict";var c;function l(e){var t;return t=e.type,Array.isArray(t)&&(e.type=e.type[0]),e.type}function t(f,u){u=u||{};var e={};return function e(t,r,i){if(t){var a,s,n;if("object"===(n=l(t))&&t.properties)for(var o in i[r]=i[r]||{},t.properties)t.properties.hasOwnProperty(o)&&(!function(e,t,r){return!r.requiredPropertiesOnly||r.requiredPropertiesOnly&&(i=e,t=t.required,a=!1,(t=t||[]).forEach(function(e){e===i&&(a=!0)}),a);var i,a}(o,t,u)||e(t.properties[o],o,i[r]));else if(t.allOf)for(a=0;a<t.allOf.length;a++)e(t.allOf[a],r,i);else if(t.$ref)e(t=function(e,t){for(var r=t.split("/").slice(1),i=r.splice(0,1)[0],a=e;i;)a=a[i],i=r.splice(0,1)[0];return a}(f,t.$ref),r,i);else if("array"===n){i[r]=[];var p=0;for((t.minItems||0<t.minItems)&&(p=t.minItems),a=0;a<p;a++)e(t.items,a,i[r])}else n=t,"[object Array]"===Object.prototype.toString.call(n.enum)?i[r]=(s=t).default||(s.enum.length?s.enum[0]:void 0):(s=(s=t).type,void 0!==c[s]&&(i[r]=function(e,t){t=t||{};var r=e.type;return e.hasOwnProperty("default")?e.default:t.hasOwnProperty(r)?"function"==typeof t[r]?t[r](e):t[r]:c[r]}(t,u.defaults)))}}(f,"kek",e),e.kek}c={string:"",number:0,integer:0,null:null,boolean:!1,object:{}};function o(e,t,r,i,a){return void 0===a&&(a={}),a={method:r.toUpperCase(),url:i+t,headers:p(e,t,r),queryString:n(e,t,r,a),httpVersion:"HTTP/1.1",cookies:[],headersSize:0,bodySize:0},(r=s(e,t,r))&&(a.postData=r),a}function s(e,t,r){if(void 0!==e.paths[t][r].parameters)for(var i in e.paths[t][r].parameters){var a,i=e.paths[t][r].parameters[i];if(void 0!==i.in&&"body"===i.in.toLowerCase()&&void 0!==i.schema)return void 0===i.schema.$ref?a=i.schema:/^http/.test(i.schema.$ref)||(i=i.schema.$ref.split("/").slice(-1)[0],a=u(e,e.definitions[i])),{mimeType:"application/json",text:JSON.stringify(f.instantiate(a))}}return null}function n(e,t,r,i){void 0===i&&(i={});var a=[];if(void 0!==e.paths[t][r].parameters)for(var s in e.paths[t][r].parameters){s=e.paths[t][r].parameters[s];void 0!==(s="string"==typeof s.$ref&&!/^http/.test(s.$ref)?y(e,s.$ref):s).in&&"query"===s.in.toLowerCase()&&a.push({name:s.name,value:void 0===i[s.name]?void 0===s.default?e.openapi?"<SOME_"+s.schema.type.toUpperCase()+"_VALUE>":"<SOME_"+s.type.toUpperCase()+"_VALUE>":s.default+"":i[s.name]+""})}return a}function p(e,t,r){var i,a,s,n=[],o=e.paths[t][r];if(void 0!==o.consumes)for(var p in o.consumes){p=o.consumes[p];n.push({name:"accept",value:p})}if(void 0!==o.produces)for(var f in o.produces){f=o.produces[f];n.push({name:"content-type",value:f})}if(void 0!==o.parameters)for(var u in o.parameters){var c=o.parameters[u];if(void 0!==c.in&&"header"===c.in.toLowerCase()){if("string"==typeof c.$ref){if(/^http/.test(c.$ref))continue;c=y(e,c.$ref)}u=(e.openapi?c.schema:c).type;n.push({name:c.name,value:"<SOME_"+u.toUpperCase()+"_VALUE>"})}}var l=e.securityDefinitions||e.components&&e.components.securitySchemes,h=o.security||e.security;if(l&&h)for(var m in h){var v=Object.keys(h[m])[0],d=l[v];if(d&&d.type)switch(d.type.toLowerCase()){case"basic":i=v;break;case"apikey":"query"===d.in&&(a=v);break;case"oauth2":s=v}}return i?n.push({name:"Authorization",value:"Basic <USERNAME:PASSWORD>"}):a?n.push({name:l[a].name,value:"REPLACE_KEY_VALUE"}):s&&n.push({name:"Authorization",value:"Bearer <BEARER_TOKEN>"}),n}var f={instantiate:t},u=function e(t,r){if("object"===r.type){if(void 0!==r.properties)for(var i in r.properties){var a=r.properties[i];"string"!=typeof a.$ref||/^http/.test(a.$ref)||(a=a.$ref.split("/").slice(-1)[0],r.properties[i]=t.definitions[a]),e(t,r.properties[i])}}else if("array"===r.type&&void 0!==r.items)for(var s in r.items)"$ref"!==s||/^http/.test(r.items[s])||(s=r.items.$ref.split("/").slice(-1)[0],r.items=t.definitions[s]),e(t,r.items);return r},y=function(e,t){var i=t.split("/");return i.length<=1?{}:function e(t,r){return r+1<i.length?e(t[i[r]],r+1):t[i[r]]}(e,1)};e.createHar=o,e.swagger2har=function(a,e){try{var s=e||(r="",(t=a).openapi?t.servers[0].url:(void 0!==t.schemes?r+=t.schemes[0]:r+="http","/"===t.basePath?r+="://"+t.host:r+="://"+t.host+t.basePath,r)),n=[];return Object.keys(a.paths).forEach(function(i){Object.keys(a.paths[i]).forEach(function(e){var t=s+i,r=o(a,i,e,s);n.push({path:i,method:e.toUpperCase(),url:t,description:a.paths[i][e].description||"No description available",har:r})})}),n}catch(e){return console.error(e),null}var t,r},Object.defineProperty(e,"__esModule",{value:!0})});
